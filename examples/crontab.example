# GitHub Summary - Automated Daily Reports
#
# This example shows how to set up automated daily email reports:
# - Monday at 6am: 72 hour report (covers weekend merges)
# - Tuesday-Friday at 6am: 24 hour report
#
# To use this:
# 1. Edit the paths, credentials, and email addresses below
# 2. Run: crontab -e
# 3. Copy the relevant sections into your crontab
# 4. Verify with: crontab -l

SHELL=/bin/bash
PATH=/usr/local/bin:/opt/homebrew/bin:/usr/bin:/bin

# ============================================================================
# ENVIRONMENT VARIABLES (defined once, apply to all jobs below)
# ============================================================================
OPENAI_API_KEY="your-api-key"
SMTP_USER="you@company.com"
SMTP_PASSWORD="your-app-password"
SMTP_FROM="you@company.com"

# ============================================================================
# SCHEDULED JOBS
# ============================================================================

# Monday at 6am - 72 hour report (covers weekend)
0 6 * * 1 /path/to/github-summary/run.sh --config /path/to/github-summary/github_summary_config_3d.yaml >> /tmp/github_summary_monday.log 2>&1

# Tuesday-Friday at 6am - 24 hour report
0 6 * * 2-5 /path/to/github-summary/run.sh --config /path/to/github-summary/github_summary_config.yaml >> /tmp/github_summary_daily.log 2>&1

# ============================================================================
# ALTERNATIVE: Using command-line arguments instead of config file
# ============================================================================

# Monday at 6am - 72 hour report with inline options
# 0 6 * * 1 /path/to/github-summary/run.sh --repos "shop/world" --labels "Slice: delivery,Slice: fulfillment" --time-range 72h --email you@company.com >> /tmp/github_summary_monday.log 2>&1

# Tuesday-Friday at 6am - 24 hour report with inline options
# 0 6 * * 2-5 /path/to/github-summary/run.sh --repos "shop/world" --labels "Slice: delivery,Slice: fulfillment" --time-range 24h --email you@company.com >> /tmp/github_summary_daily.log 2>&1

# ============================================================================
# REQUIRED ENVIRONMENT VARIABLES
# ============================================================================
# OPENAI_API_KEY  - Your Anthropic API key (or Shopify AI proxy token)
# SMTP_USER       - Email address for SMTP authentication
# SMTP_PASSWORD   - App password for SMTP (see docs/EMAIL_SETUP.md)
# SMTP_FROM       - Sender email address (usually same as SMTP_USER)
#
# Optional:
# GITHUB_TOKEN    - Only needed if gh CLI isn't authenticated

# ============================================================================
# CRON SCHEDULE FORMAT
# ============================================================================
# ┌───────────── minute (0 - 59)
# │ ┌───────────── hour (0 - 23)
# │ │ ┌───────────── day of month (1 - 31)
# │ │ │ ┌───────────── month (1 - 12)
# │ │ │ │ ┌───────────── day of week (0 - 6) (Sunday to Saturday)
# │ │ │ │ │
# * * * * * command to execute
#
# Examples:
# 0 6 * * *     - Every day at 6am
# 0 6 * * 1     - Every Monday at 6am
# 0 6 * * 1-5   - Monday through Friday at 6am
# 0 */6 * * *   - Every 6 hours
# 0 9,17 * * *  - At 9am and 5pm every day

# ============================================================================
# TROUBLESHOOTING
# ============================================================================
#
# 1. Check logs:
#    tail -f /tmp/github_summary_daily.log
#    tail -f /tmp/github_summary_monday.log
#
# 2. Test command manually first (replace with your actual values):
#    OPENAI_API_KEY="key" SMTP_USER="you@co.com" SMTP_PASSWORD="pass" SMTP_FROM="you@co.com" /path/to/run.sh --config /path/to/config.yaml
#
# 3. Verify cron job is installed:
#    crontab -l
#
# 4. Check if cron is running:
#    ps aux | grep cron
#
# 5. Verify timezone:
#    date
#
# 6. Email not arriving:
#    - Check spam folder
#    - Verify SMTP credentials
#    - Check error logs
#    - See docs/EMAIL_SETUP.md for detailed troubleshooting
